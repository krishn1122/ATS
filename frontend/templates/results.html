{% extends "base.html" %}

{% block title %}Analysis Results - Smart ATS{% endblock %}

{% block content %}
<div class="container py-4">
    <!-- Header -->
    <div class="text-center mb-5" data-aos="fade-up">
        <h1 class="fw-bold text-primary">Resume Analysis Results</h1>
        <p class="lead text-muted">Comprehensive ATS evaluation and recommendations</p>
    </div>

    <!-- Overall Score -->
    <div class="row mb-5">
        <div class="col-lg-12">
            <div class="result-card text-center" data-aos="fade-up">
                <h3 class="fw-bold text-primary mb-4">Overall ATS Score</h3>
                <div class="score-circle" id="scoreCircle">
                    <span id="overallScore">--</span>
                </div>
                <p class="mt-3 text-muted">Based on job description alignment, grammar, format, and readability</p>
            </div>
        </div>
    </div>

    <!-- Key Metrics -->
    <div class="row mb-5 g-4">
        <div class="col-md-3" data-aos="fade-up" data-aos-delay="100">
            <div class="result-card text-center h-100">
                <div class="metric-icon mb-3">
                    <i class="fas fa-bullseye fa-2x text-primary"></i>
                </div>
                <h4 class="fw-bold" id="jdMatch">--</h4>
                <p class="text-muted mb-0">Job Match</p>
            </div>
        </div>
        <div class="col-md-3" data-aos="fade-up" data-aos-delay="200">
            <div class="result-card text-center h-100">
                <div class="metric-icon mb-3">
                    <i class="fas fa-eye fa-2x text-success"></i>
                </div>
                <h4 class="fw-bold" id="readabilityScore">--</h4>
                <p class="text-muted mb-0">Readability</p>
            </div>
        </div>
        <div class="col-md-3" data-aos="fade-up" data-aos-delay="300">
            <div class="result-card text-center h-100">
                <div class="metric-icon mb-3">
                    <i class="fas fa-spell-check fa-2x text-warning"></i>
                </div>
                <h4 class="fw-bold" id="grammarIssues">--</h4>
                <p class="text-muted mb-0">Grammar Issues</p>
            </div>
        </div>
        <div class="col-md-3" data-aos="fade-up" data-aos-delay="400">
            <div class="result-card text-center h-100">
                <div class="metric-icon mb-3">
                    <i class="fas fa-redo-alt fa-2x text-info"></i>
                </div>
                <h4 class="fw-bold" id="repetitionIssues">--</h4>
                <p class="text-muted mb-0">Repetition Issues</p>
            </div>
        </div>
    </div>

    <!-- Profile Summary -->
    <div class="row mb-5">
        <div class="col-lg-12">
            <div class="result-card" data-aos="fade-up">
                <h4 class="fw-bold text-primary mb-3">
                    <i class="fas fa-user-circle me-2"></i>Profile Summary
                </h4>
                <p id="profileSummary" class="lead">Loading analysis summary...</p>
            </div>
        </div>
    </div>

    <!-- Missing Keywords -->
    <div class="row mb-5">
        <div class="col-lg-12">
            <div class="result-card" data-aos="fade-up">
                <h4 class="fw-bold text-primary mb-3">
                    <i class="fas fa-tags me-2"></i>Missing Keywords
                </h4>
                <p class="text-muted mb-3">Important keywords from the job description that are missing from your resume:</p>
                <div id="missingKeywords">
                    <div class="text-center">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Detailed Analysis Tabs -->
    <div class="row">
        <div class="col-lg-12">
            <div class="result-card" data-aos="fade-up">
                <h4 class="fw-bold text-primary mb-4">
                    <i class="fas fa-chart-line me-2"></i>Detailed Analysis
                </h4>
                
                <!-- Navigation Tabs -->
                <ul class="nav nav-tabs nav-justified mb-4" id="analysisTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="grammar-tab" data-bs-toggle="tab" data-bs-target="#grammar" type="button" role="tab">
                            <i class="fas fa-spell-check me-2"></i>Grammar & Writing
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="repetition-tab" data-bs-toggle="tab" data-bs-target="#repetition" type="button" role="tab">
                            <i class="fas fa-redo-alt me-2"></i>Word Usage
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="format-tab" data-bs-toggle="tab" data-bs-target="#format" type="button" role="tab">
                            <i class="fas fa-file-alt me-2"></i>Format & Structure
                        </button>
                    </li>
                </ul>

                <!-- Tab Content -->
                <div class="tab-content" id="analysisTabContent">
                    <!-- Grammar Issues -->
                    <div class="tab-pane fade show active" id="grammar" role="tabpanel">
                        <h5 class="fw-semibold mb-3">Grammar and Writing Issues</h5>
                        <div id="grammarIssues">
                            <div class="text-center">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Repetition Issues -->
                    <div class="tab-pane fade" id="repetition" role="tabpanel">
                        <h5 class="fw-semibold mb-3">Word Repetition Analysis</h5>
                        <p class="text-muted mb-3">Words that appear frequently in your resume:</p>
                        <div id="repetitionIssues">
                            <div class="text-center">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Format Issues -->
                    <div class="tab-pane fade" id="format" role="tabpanel">
                        <h5 class="fw-semibold mb-3">Format and Readability</h5>
                        <p class="text-muted mb-3">Structural and formatting recommendations:</p>
                        <div id="formatIssues">
                            <div class="text-center">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Action Buttons -->
    <div class="row mt-5">
        <div class="col-lg-12 text-center">
            <div class="d-flex gap-3 justify-content-center flex-wrap">
                <a href="/" class="btn btn-primary btn-lg">
                    <i class="fas fa-upload me-2"></i>Analyze Another Resume
                </a>
                <button class="btn btn-outline-primary btn-lg" onclick="window.print()">
                    <i class="fas fa-print me-2"></i>Print Results
                </button>
                <a href="/dashboard" class="btn btn-outline-secondary btn-lg">
                    <i class="fas fa-chart-bar me-2"></i>View Dashboard
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize AOS
    AOS.init({
        duration: 800,
        easing: 'ease-in-out',
        once: true
    });

    // Initialize results page
    if (window.ResultsPage) {
        new window.ResultsPage();
    }
});
</script>
{% endblock %}